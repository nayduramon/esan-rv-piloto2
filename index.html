<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>ESAN 360 - Trayectoria histórica</title>

  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-particle-system-component@1.1.3/dist/aframe-particle-system-component.min.js"></script>
</head>

<body>
  <a-scene>

    <a-assets>
      <img id="esan360" src="gth.jpeg">
      <video id="videoUni" src="video2.mp4" loop="false" crossorigin="anonymous" playsinline webkit-playsinline>
      </video>
    </a-assets>

    <a-sky src="#esan360" rotation="0 -90 0"></a-sky>

    <!-- TELÓN NEGRO -->
    <a-sphere
      id="telonNegro"
      radius="60"
      material="color: #000; side: back; transparent: true; opacity: 0; shader: flat"
      animation__oscurecer="property: material.opacity; to: 1; dur: 3000; startEvents: cineStart; easing: easeInOutQuad"
      animation__aclarar="property: material.opacity; to: 0; dur: 3000; startEvents: cineEnd; easing: easeInOutQuad">
    </a-sphere>

    <!-- ⭐ ESTRELLAS -->
    <a-entity
      id="estrellas"
      visible="false"
      particle-system="
        preset: default;
        particleCount: 1200;
        color: #FFFFFF;
        size: 0.6;
        opacity: 0.9;
        velocityValue: 0 0 -0.05;
        accelerationValue: 0 0 0;
        maxAge: 12;
        blending: additive;
      ">
    </a-entity>

    <!-- VIDEO -->
    <a-video
      id="pantallaVideo"
      src="#videoUni"
      width="5"
      height="3"
      position="0 1.6 -30"
      visible="false"
      animation__entrar="property: position; to: 0 1.6 -4; dur: 8000; easing: easeOutCubic; startEvents: videoEntra"
      animation__salir="property: position; to: 0 1.6 -30; dur: 4000; easing: easeInQuad; startEvents: videoSale">
    </a-video>

    <!-- BOTÓN -->
    <a-entity
      id="contenedorBoton"
      position="0 1.6 -15"
      visible="true"
      animation="property: position; to: 0 1.6 -2.5; dur: 8000; easing: easeOutCubic; delay: 500">

      <a-circle
        id="btnAccion"
        class="clickable"
        color="#000000"
        opacity="0.6"
        radius="0.65"
        animation__mouseenter="property: scale; to: 1.1 1.1 1; dur: 200; startEvents: mouseenter"
        animation__mouseleave="property: scale; to: 1 1 1; dur: 200; startEvents: mouseleave">

        <a-text
          id="textoBoton"
          value="CONOCE NUESTRA\nHISTORIA"
          align="center"
          color="#FFFFFF"
          font="kelsonsans"
          width="1"
          wrap-count="20"
          anchor="center"
          baseline="center">
        </a-text>

      </a-circle>
    </a-entity>

    <!-- CÁMARA -->
    <a-entity camera look-controls position="0 1.6 0">
      <a-cursor
        id="cursor"
        color="#FFD700"
        radius="0.015"
        scale="0.3 0.3 0.3"
        raycaster="objects: .clickable"
        animation__click="property: scale; startEvents: click; from: 0.2 0.2 0.2; to: 0.3 0.3 0.3; dur: 120">
      </a-cursor>
    </a-entity>

  </a-scene>

  <script>
    const video = document.querySelector('#videoUni');
    const pantalla = document.querySelector('#pantallaVideo');
    const contenedorBtn = document.querySelector('#contenedorBoton');
    const btnAccion = document.querySelector('#btnAccion');
    const textoBoton = document.querySelector('#textoBoton');
    const telonNegro = document.querySelector('#telonNegro');
    const estrellas = document.querySelector('#estrellas');

    const animacionBotonConfig =
      "property: position; to: 0 1.6 -2.5; dur: 8000; easing: easeOutCubic; delay: 500";

    // --- CLIC EN BOTÓN ---
    btnAccion.addEventListener('click', function() {
      contenedorBtn.setAttribute('visible', 'false');

      telonNegro.emit('cineStart');
      estrellas.setAttribute('visible', 'true');

      video.muted = false;
      video.currentTime = 0;

      pantalla.setAttribute('visible', 'true');
      pantalla.emit('videoEntra');

      setTimeout(() => {
        video.play();
      }, 1000);
    });

    // --- FIN DEL VIDEO ---
    video.addEventListener('ended', function() {
      telonNegro.emit('cineEnd');
      estrellas.setAttribute('visible', 'false');

      pantalla.emit('videoSale');

      setTimeout(() => {
        pantalla.setAttribute('visible', 'false');

        textoBoton.setAttribute(
          'value',
          'VUELVE A VER\nNUESTRA\nHISTORIA'
        );

        contenedorBtn.setAttribute('visible', 'true');
        contenedorBtn.setAttribute('position', '0 1.6 -15');
        contenedorBtn.removeAttribute('animation');

        setTimeout(() => {
          contenedorBtn.setAttribute('animation', animacionBotonConfig);
        }, 50);

      }, 4000);
    });
  </script>

</body>
</html>













